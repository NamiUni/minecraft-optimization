# よくある落とし穴とベスト・プラクティス

この記事では、サーバーオーナーが直面するよくある落とし穴について説明することを目的としています。

## 常にバックアップする
バックアップを取る人と、これから取る人の2種類がいます。データ消失の経験は時間の問題です。ワールドやプラグインのデータが失われないように、常にコピーを取っておきましょう。これはマインクラフトに限らず、コンピュータ関連のあらゆるワークフローに応用できます。

## 時代遅れのソフトウェアを使わない
古いバージョンのソフトウェアを使用することで、プレイヤーがパッチの当たっていないエクスプロイトを悪用する危険性があります。また、プレイヤーはあなたのサーバーに合わせてクライアントのバージョンを下げなければならないため、不便さを感じることになります。これはプロトコルハックで回避することができますが、理想的ではありません。

## bukkit/spigotの動作を停止する
BukkitとSpigotは、基本的にメインテナンスモードです。新しいバージョンが出たり、重大なエクスプロイトが発見されたりした場合にはアップデートを行いますが、パフォーマンスに関するアップデートは一切行いません。つまり、これらのソフトウェアで経験したパフォーマンスの問題は、時間が経っても改善されないということです。それを避けるためには、[paper](https://papermc.io/downloads)、[tuinity](https://ci.codemc.io/job/Spottedleaf/job/Tuinity)、[purpur](https://purpur.pl3x.net/downloads)にアップグレードしてください。Bukkit/Spigotプラグインは、リストアップされているサーバソフトウェアと同様に（あるいはそれ以上に）動作します。もし動作しない場合は、そのプラグインの開発者がしてはいけないことをしているか、プラグインの作成を怠っていると考えてよいでしょう。また、複数のCPUスレッドを利用できるチャンクローディングシステムや、実際にプレイヤーに送信するチャンク数よりも少ない数のチャンクをサーバーがティックする設定など、最適化のためのパッチも追加されています。詳しくは[main optimization guide](https://github.com/YouHaveTrouble/minecraft-optimization)をご覧ください。

## 可能な限り共有ホスティングを避ける
共有ホストは通常、最も安い選択肢ですが、それには正当な理由があります。このホストは2種類のリソースを提供します - 保証付きと共有です。保証されたリソースは通常、笑えるほど低く、数人のプレイヤーのためのサーバーを運営するには十分ではありません。一方、共有リソースは、通常、そこそこのパフォーマンスでサーバーを運営するのに十分です。共有リソースは、その名の通り、自分のサーバーと同じ物理マシン上の他のサーバーとの間で共有されます。他のサーバーが共有リソースを使用していない場合にのみ、サーバーは共有リソースの恩恵を受けることができます。ほとんどの共有ホストがリソースを過剰に提供しているため、お客様のサーバーが共有リソースを完全に利用するという状況はほとんど起こりません。ホスティングサイトは、航空券のように、利用可能なリソースよりも多くのリソースを販売し、すべてのリソースが使用されないことを期待しています。そのため、リソースが足りずにすべてのサーバーが停止してしまうことがよくあります。

## コマンド機能を使用するデータパックを避ける
コマンドを実行するデータパックは非常にラグが大きいです。数人のプレイヤーではさほど気にならないかもしれませんが、プレイ人数に応じてうまく調整できず、プレイヤーが増えるとすぐにサーバーが遅延してしまいます。バイオームやルートテーブルなどを変更するデータパックは問題ありません。プラグインの代わりになるものを探した方がいいでしょう。

## ハードウェアの選択
必要なRAMの容量だけで判断してはいけません。CPUはサーバーの最も重要な部分なので、どのような種類のCPUを使うべきかに注目すべきです。サーバーは主に1つのスレッドで動作しているので、[シングルコアパフォーマンスに優れたもの](https://www.cpubenchmark.net/singleThread.html)がいいでしょう。しかし、paperの上での非同期チャンクローディングのようなシステムでは、かなり前からマルチスレッドが利用されています。

HDDドライブは絶対に避けるべきです。マインクラフトはI/O操作が多いので（特に視界距離が長く、プレイヤー数が多い場合）、その速度はサーバーを運営するにはあまりにも遅いのです。
